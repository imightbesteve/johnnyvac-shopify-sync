name: Sync JohnnyVac to Shopify
on:
  schedule:
    # Run 5 times per week on alternating schedule
    - cron: '0 6 * * 1,2,3,4,5'  # Mon-Fri at 6 AM UTC
  workflow_dispatch:  # Manual trigger with options
    inputs:
      category_mode:
        description: 'Category Mode'
        required: false
        default: 'alternate'
        type: choice
        options:
          - alternate  # Group A: Mon/Wed/Fri, Group B: Tue/Thu/Sat
          - rotate     # Auto-rotate through categories daily
          - all        # Sync all categories (may timeout)
          - specific   # Enter specific category name below
      category_name:
        description: 'Specific Category Name (if mode=specific)'
        required: false
        type: string

jobs:
  sync:
    runs-on: ubuntu-latest
    timeout-minutes: 360
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
      
      - name: Install dependencies
        run: |
          pip install requests
      
      - name: Run sync script
        env:
          SHOPIFY_STORE: ${{ secrets.SHOPIFY_STORE }}
          SHOPIFY_ACCESS_TOKEN: ${{ secrets.SHOPIFY_ACCESS_TOKEN }}
          CATEGORY_MODE: ${{ github.event.inputs.category_mode || 'alternate' }}
          CATEGORY_NAME: ${{ github.event.inputs.category_name || '' }}
        run: |
          # If specific category requested, use category name
          if [ "$CATEGORY_MODE" = "specific" ] && [ -n "$CATEGORY_NAME" ]; then
            export CATEGORY_MODE="$CATEGORY_NAME"
          fi
          python sync_shopify.py
```

## ðŸ“… How the Alternating Schedule Works

### **Automatic Split:**
The script automatically divides your categories into two equal groups based on the number of products:

**Example with 7 categories:**
```
Group A (Mon/Wed/Fri):          Group B (Tue/Thu):
â”œâ”€ Floor Care (2,340)           â”œâ”€ Paper Products (1,100)
â”œâ”€ Chemicals (1,850)            â”œâ”€ Equipment (890)
â”œâ”€ Vacuums (1,420)              â”œâ”€ Accessories (650)
â””â”€ Safety (264)                 â””â”€ (Total: 2,640)
   (Total: 5,874)
```

### **Weekly Pattern:**
```
Monday    â†’ Group A (Floor Care, Chemicals, Vacuums, Safety)
Tuesday   â†’ Group B (Paper Products, Equipment, Accessories)
Wednesday â†’ Group A (Floor Care, Chemicals, Vacuums, Safety)
Thursday  â†’ Group B (Paper Products, Equipment, Accessories)
Friday    â†’ Group A (Floor Care, Chemicals, Vacuums, Safety)
Saturday  â†’ Group B runs if you trigger manually
Sunday    â†’ Group B runs if you trigger manually
